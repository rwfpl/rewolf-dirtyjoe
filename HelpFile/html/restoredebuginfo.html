<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>Restore Debug Info</title>
<meta http-equiv="content-type" content="text/html">
</head>

<body style="font-family: Arial; font-size: 12pt;">
<Object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
	<param name="Keyword" value="Restore Debug Info">
	<param name="Keyword" value="LocalVariableTable">
    <param name="Keyword" value="LineNumberTable">
</OBJECT>
<hr>
<div><div align=center>
<table width=800 border=0 cellpadding=1 cellspacing=2 style="border-width: 0px;">
<tr>
<td style="text-align: justify;">
    <p>
    <b>Restore Debug Info</b> functionality is accessible from the <b><i>Tools</i></b> menu and from the command line (command
    line support is described at the end).
    <p align="center"><img src="screens/restore_debug_wnd.png"></p>
    The main idea behind this feature is to enable bytecode-level debugging of any .class file in any source-level
    Java debugger (e.g. JSwat, jdb). Restoring debug information consist of two stages:<br />
    <ul>
        <li>Restoring Line Numbers</li>
        <li>Restoring Local Variables</li>
    </ul>
    Restoring line numbers is fairly easy, it justs generates LineNumberTable attribute for each function. Line numbers
    inside this attribute are paired with line numbers taken from disassembled file (with .joe extension). Example of generated
    .joe file can be found below:<br />
    <pre>
;-------------------------------------------------------------------------------
; File generated by dirtyJOE v1.6 (c466) (x86)
; Copyright © 2008-2013 ReWolf
; http://dirty-joe.com
; joe@dirty-joe.com
;-------------------------------------------------------------------------------

java.lang.Object getObjectLock()
00000000: 	aload_0
00000001: 	getfield            java.lang.Object java.awt.Component.objectLock
00000004: 	areturn
;-------------------------------------------------------------------------------

int getBoundsOp()
00000000: 	getstatic           boolean java.awt.Component.$assertionsDisabled
00000003: 	ifne                pos.00000018
00000006: 	aload_0
    </pre>
    Restoring local variables is experimental feature and it might not work as supposed. Currently it tries to assign
    proper type (int, long, float, double, object reference) and scope to every local variable referenced in the bytecode.
    For object references it will always assign java.lang.Object type, as it doesn't perform any deep analysis of the function.
    Scope of the variable is based on the simple analysis of control flow instructions and exception handlers.
    <hr />
    <h2>Command line support</h2>
    Restore Debug Info feature is also available directly from the command line:<br />
    <p align="center"><img src="screens/restore_debug_cmd.png"></p>
    dirtyJOE should be started through "start /WAIT" command, as it is not console application thus it will run asynchronously
    without this command:
    <pre>
    start /WAIT dirtyJOE.exe /rdi class_file.class
    </pre>
    Command line support was introduced to help with restoring debug info in multiple files. Below command will restore debug information
    for all files in the current directory and all subdirectories (.joe files will be placed in the same subdirectories as input .class files):
    <pre>
    for /R %c in (*.class) do start /WAIT dirtyJOE.exe /rdi "%c"
    </pre>
    <mark>
    <table bgcolor="yellow"><td ackground="yellow">Command line version of <b>Restore Debug Info</b> doesn't create copy of the input class file thus you should always work on backup
    copy of the class file. It will also overwrite all existing .joe disassembled files.</td></table>
    </mark>
    </p>
</td>
</tr>
</table>
</div></div>
<br />
<hr />
<small><center>(C) 2008-2014, ReWolf</center></small>
</body>
</html>
